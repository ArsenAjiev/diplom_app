{% load bootstrap4 %}
{% load static %}
{% load crispy_forms_tags %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>{% block title %}Главная{% endblock %} - Сайт о кино </title>
    {% bootstrap_css %}
    <link rel="stylesheet" type="text/css"
          href="#">
    {% bootstrap_javascript jquery='slim' %}
</head>
<body class="container-fluid">
<header class="mb-4">
    <h1 class="display-1 text-center">База данных фильмов</h1>
</header>


<div class=" container">

    <p class="row">


    <ul class="col nav justify-content-end border">
        <li class="nav-item"><a class="nav-link"
                                href="{% url 'register' %}">Регистрация</a></li>
        {% if user.is_authenticated %}
            <div class="alert alert-primary" role="alert">
                Добро пожаловать :{{ user.get_username }}
            </div>

            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" data-toggle="dropdown"
                   href="#" role="button" aria-haspopup="true"
                   aria-expanded="false">Профиль</a>

                <div class="dropdown-menu">
                    <a class="dropdown-item" href="{% url 'profile' %}">Моя страница</a>
                    <a class="dropdown-item" href="{% url 'my_comment' %}">Мои коментарии</a>
                    <a class="dropdown-item" href="{% url "logout" %}?next={% url 'home' %}">Выйти</a>
                    <div class="dropdown-divider"></div>
                    {#                        <a class="dropdown-item" href="{% url "main:profile_delete" %}">Удалить</a>#}
                </div>
            </li>
        {% else %}
            <li class="nav-item"><a class="nav-link" href="{% url "login" %}?next={% url 'profile' %}">Вход</a></li>
        {% endif %}
    </ul>
</div>
<div class="row">
    <nav class="col-md-2 nav flex-column border">
        <a class="nav-link root"
           href="{% url 'home' %}">Главная</a>
        <span class="nav-link root font-weight-bold">
                Заголовок1</span>
        <a class="nav-link" href="{% url 'comment' %}"> Коментарии </a>
        <a class="nav-link" href="#"> Текст2 </a>
        <a class="nav-link" href="#"> Текст3 </a>
        <span class="nav-link root font-weight-bold">
                Заголовок2 </span>
        <a class="nav-link" href="{% url 'news' %}"> Новости </a>
        <a class="nav-link" href="#"> Текст5 </a>
        <a class="nav-link root" href="#"> О сайте </a>
    </nav>


    <section class="col border py-2">

        {% block content %}

            {% if user.is_superuser %}
                sueruser
            {% else %}
                not superuser
            {% endif %}

            <p>Главная страница сайта </p>
            <div class="col-md-9">
                <div class=" container border border-primary ">
                        {% bootstrap_messages %}

                    {% if user.is_superuser %}

                        <form method="POST">
                            <h2> Enter title and release year </h2>
                            {% csrf_token %}
                            {{ form|crispy }}
                            <button type="submit" class="btn btn-primary"> Add movie</button>

                            {% if message %}
                                <div class="{{ message_class }} col-3"> {{ message }} </div>
                            {% endif %}
                        </form>
                    {% endif %}
                </div>

                {% for movie in movies %}
                    <div class="container border border-primary">
                        <div class="alert alert-primary" role="alert"></div>
                        <div class="row">
                            <div class="col-md-3 border border-primary">
                                <h5>TITLE: </h5><span class="title"> {{ movie.title }}</span>
                            </div>
                            <div class="col-md-3 border border-primary">
                                <h5>YEAR: </h5><span class="title">{{ movie.year }}</span>
                            </div>
                            <div class="col-md-3 border border-primary">
                                <h5>RELEASED: </h5><span class="title">{{ movie.released }}</span>
                            </div>
                            <div class="col-md-3 border border-primary">
                                <h5>imbd: </h5><span class="title">{{ movie.imdb_id }}</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 border border-primary">
                                <img src=" /static/img{{ movie.image.url }}" alt="" height="350" border="12">
                            </div>
                            <div class="col-md-8 border border-primary">
                                <h5>PLOT: </h5> {{ movie.plot }}
                            </div>
                            <div class="col-md-8 border border-primary">
                                <a href="{% url 'add_movie' movie.pk %}">
                                    <button class="btn btn-info"> ADD MOVIE TO PROFILE</button>
                                </a>

                         {% if user.is_superuser %}
                        <a href="{% url 'delete_movie' movie.pk %}">
                        <button class="delete btn btn-danger"> DELETE </button>
                        </a>
                        {% endif %}


                            </div>
                        </div>
                        <div class="alert alert-primary" role="alert">
                            <h5>CREATED_AT: </h5><span class="title">{{ movie.created_at }}</span>
                        </div>

                    </div>
                {% endfor %}
            </div>

                <div class="pagination">
        <span class="step-links">
          {% if movies.has_previous %}
            <a href="?page=1" class="btn btn-primary">&laquo; first</a>
            <a href="?page={{ movies.previous_page_number }}" class="btn btn-primary">previous</a>
          {% endif %}
            <span class="current">
                Page {{ movies.number }} of {{ movies.paginator.num_pages }}.
            </span>
          {% if movies.has_next %}
            <a href="?page={{ movies.next_page_number }} " class="btn btn-primary">next</a>
            <a href="?page={{ movies.paginator.num_pages }}" class="btn btn-primary">last &raquo;</a>
          {% endif %}
          </span>
      </div>
        {% endblock %}
    </section>
</div>
</div>

<footer class="mt-3">
    <p class="text-right font-italic">&copy; сайт</p>
</footer>
</body>
</html>